@echo off

set "healthCheckUrl=http://example.com/health"  REM replace with your actual health check URL
set "startScript=StartService.bat"              REM replace with the name of your start batch file

powershell -command "(Invoke-WebRequest -Uri '%healthCheckUrl%').StatusCode" | find "200" > nul

if %errorlevel% neq 0 (
    echo URL is down! Starting the service...
    call %startScript%
) else (
    echo URL is up. No action needed.
)

exit /b %errorlevel%


@echo off

for /f %%A in ('powershell -command "(Invoke-WebRequest -Uri '%healthCheckUrl%').StatusCode" ^| find /v "d"') do set "statusCode=%%A"

set "statusCode=%statusCode:~0,-1%"  REM Remove the trailing carriage return character


set "healthCheckUrl=http://example.com/health"  REM replace with your actual health check URL
set "startScript=StartService.bat"              REM replace with the name of your start batch file

for /f %%A in ('powershell -command "(Invoke-WebRequest -Uri '%healthCheckUrl%').StatusCode"') do set "statusCode=%%A"
timeout /t 2 /nobreak >nul  
if "%statusCode%" neq "200" (
    echo URL is down! Starting the service...
    call %startScript%
) else (
    echo URL is up. No action needed.
)

exit /b 0
